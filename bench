#!/bin/bash

minbench=1
maxbench=2
a=$1

function b1() {
    echo nocode.rs without emscripten
    rustc --target=wasm32-unknown-unknown -o bin/b1.wasm src/nocode.rs
}

function b2() {
    echo nocode.rs without emscripten
    rustc --target=wasm32-unknown-emscripten -o bin/b2.wasm src/nocode.rs
}

function bn() {
    echo "executing benchmark '$1'"
    case $1 in
        1) b1;;
        2) b2;;
        *) echo error: fatal input error;;
    esac
}

if [[ $# -eq 0 ]]; then
    echo error: needing at least one argument
else
    case $1 in
        all)
            echo bench all
            for i in $(seq $minbench $maxbench); do
                bn $i 
            done
            ;;
        *)              
            if (($minbench<=$a && $a<=$maxbench)); then
                bn $a
            else
                echo "error: needing number argument in the range of 1..$maxbench or 'all'"
            fi
            ;;
    esac
fi
